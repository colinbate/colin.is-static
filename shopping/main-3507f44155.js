function onUpdateReady(){alert("New version available, refresh to upgrade.")}!function(){"use strict";function t(e,n){function o(t,e){return function(){return t.apply(e,arguments)}}var s;if(n=n||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=n.touchBoundary||10,this.layer=e,this.tapDelay=n.tapDelay||200,this.tapTimeout=n.tapTimeout||700,!t.notNeeded(e)){for(var a=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],r=this,l=0,c=a.length;c>l;l++)r[a[l]]=o(r[a[l]],r);i&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,i,n){var o=Node.prototype.removeEventListener;"click"===t?o.call(e,t,i.hijacked||i,n):o.call(e,t,i,n)},e.addEventListener=function(t,i,n){var o=Node.prototype.addEventListener;"click"===t?o.call(e,t,i.hijacked||(i.hijacked=function(t){t.propagationStopped||i(t)}),n):o.call(e,t,i,n)}),"function"==typeof e.onclick&&(s=e.onclick,e.addEventListener("click",function(t){s(t)},!1),e.onclick=null)}}var e=navigator.userAgent.indexOf("Windows Phone")>=0,i=navigator.userAgent.indexOf("Android")>0&&!e,n=/iP(ad|hone|od)/.test(navigator.userAgent)&&!e,o=n&&/OS 4_\d(_\d)?/.test(navigator.userAgent),s=n&&/OS [6-7]_\d/.test(navigator.userAgent),a=navigator.userAgent.indexOf("BB10")>0;t.prototype.needsClick=function(t){switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if(n&&"file"===t.type||t.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(t.className)},t.prototype.needsFocus=function(t){switch(t.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!i;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}},t.prototype.sendClick=function(t,e){var i,n;document.activeElement&&document.activeElement!==t&&document.activeElement.blur(),n=e.changedTouches[0],i=document.createEvent("MouseEvents"),i.initMouseEvent(this.determineEventType(t),!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),i.forwardedTouchEvent=!0,t.dispatchEvent(i)},t.prototype.determineEventType=function(t){return i&&"select"===t.tagName.toLowerCase()?"mousedown":"click"},t.prototype.focus=function(t){var e;n&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type&&"month"!==t.type?(e=t.value.length,t.setSelectionRange(e,e)):t.focus()},t.prototype.updateScrollParent=function(t){var e,i;if(e=t.fastClickScrollParent,!e||!e.contains(t)){i=t;do{if(i.scrollHeight>i.offsetHeight){e=i,t.fastClickScrollParent=i;break}i=i.parentElement}while(i)}e&&(e.fastClickLastScrollTop=e.scrollTop)},t.prototype.getTargetElementFromEventTarget=function(t){return t.nodeType===Node.TEXT_NODE?t.parentNode:t},t.prototype.onTouchStart=function(t){var e,i,s;if(t.targetTouches.length>1)return!0;if(e=this.getTargetElementFromEventTarget(t.target),i=t.targetTouches[0],n){if(s=window.getSelection(),s.rangeCount&&!s.isCollapsed)return!0;if(!o){if(i.identifier&&i.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=i.identifier,this.updateScrollParent(e)}}return this.trackingClick=!0,this.trackingClickStart=t.timeStamp,this.targetElement=e,this.touchStartX=i.pageX,this.touchStartY=i.pageY,t.timeStamp-this.lastClickTime<this.tapDelay&&t.preventDefault(),!0},t.prototype.touchHasMoved=function(t){var e=t.changedTouches[0],i=this.touchBoundary;return Math.abs(e.pageX-this.touchStartX)>i||Math.abs(e.pageY-this.touchStartY)>i?!0:!1},t.prototype.onTouchMove=function(t){return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},t.prototype.findControl=function(t){return void 0!==t.control?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},t.prototype.onTouchEnd=function(t){var e,a,r,l,c,u=this.targetElement;if(!this.trackingClick)return!0;if(t.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(t.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=t.timeStamp,a=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,s&&(c=t.changedTouches[0],u=document.elementFromPoint(c.pageX-window.pageXOffset,c.pageY-window.pageYOffset)||u,u.fastClickScrollParent=this.targetElement.fastClickScrollParent),r=u.tagName.toLowerCase(),"label"===r){if(e=this.findControl(u)){if(this.focus(u),i)return!1;u=e}}else if(this.needsFocus(u))return t.timeStamp-a>100||n&&window.top!==window&&"input"===r?(this.targetElement=null,!1):(this.focus(u),this.sendClick(u,t),n&&"select"===r||(this.targetElement=null,t.preventDefault()),!1);return n&&!o&&(l=u.fastClickScrollParent,l&&l.fastClickLastScrollTop!==l.scrollTop)?!0:(this.needsClick(u)||(t.preventDefault(),this.sendClick(u,t)),!1)},t.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},t.prototype.onMouse=function(t){return this.targetElement?t.forwardedTouchEvent?!0:t.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)?(t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),!1):!0:!0},t.prototype.onClick=function(t){var e;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===t.target.type&&0===t.detail?!0:(e=this.onMouse(t),e||(this.targetElement=null),e)},t.prototype.destroy=function(){var t=this.layer;i&&(t.removeEventListener("mouseover",this.onMouse,!0),t.removeEventListener("mousedown",this.onMouse,!0),t.removeEventListener("mouseup",this.onMouse,!0)),t.removeEventListener("click",this.onClick,!0),t.removeEventListener("touchstart",this.onTouchStart,!1),t.removeEventListener("touchmove",this.onTouchMove,!1),t.removeEventListener("touchend",this.onTouchEnd,!1),t.removeEventListener("touchcancel",this.onTouchCancel,!1)},t.notNeeded=function(t){var e,n,o,s;if("undefined"==typeof window.ontouchstart)return!0;if(n=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!i)return!0;if(e=document.querySelector("meta[name=viewport]")){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(n>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(a&&(o=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),o[1]>=10&&o[2]>=3&&(e=document.querySelector("meta[name=viewport]")))){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===t.style.msTouchAction||"manipulation"===t.style.touchAction?!0:(s=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],s>=27&&(e=document.querySelector("meta[name=viewport]"),e&&(-1!==e.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))?!0:"none"===t.style.touchAction||"manipulation"===t.style.touchAction?!0:!1)},t.attach=function(e,i){return new t(e,i)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return t}):"undefined"!=typeof module&&module.exports?(module.exports=t.attach,module.exports.FastClick=t):window.FastClick=t}();var app=app||{};app.util=app.util||{},app.util.OrderedMap=function(t){var e=this;this.items={},this.keys=[],Object.defineProperty(this,"length",{get:function(){return e.keys.length}}),t&&this.addRange(t)};var addWithOp=function(t,e,i){null!=t&&(e=e||this.getKey(t),this.items[e]=t,this.keys[i](e))};app.util.OrderedMap.prototype.push=function(t,e){addWithOp.call(this,t,e,"push")},app.util.OrderedMap.prototype.unshift=function(t,e){addWithOp.call(this,t,e,"unshift")},app.util.OrderedMap.prototype.add=app.util.OrderedMap.prototype.push;var remove=function(t,e){delete this.items[t],this.keys.splice(e,1)};app.util.OrderedMap.prototype.removeKey=function(t){var e=this.keys.indexOf(t);remove.call(this,t,e)},app.util.OrderedMap.prototype.removeIndex=function(t){var e=this.keys[t];remove.call(this,e,t)},app.util.OrderedMap.prototype.removeItem=function(t){var e=this.getKey(t);this.removeKey(e)},app.util.OrderedMap.prototype.containsKey=function(t){return t in this.items};var keySort=function(t,e,i){this.items[e],this.items[i];return t(e,i)};app.util.OrderedMap.prototype.sort=function(t){"function"==typeof t&&this.keys.sort(keySort.bind(this,t))},app.util.OrderedMap.prototype.groupByMap=function(t,e,i,n){var o,s,a,r,l={},c=this.keys.length,u=[],p=0;if(!t)return this.map(i,n);for(s=0;c>s;s+=1)o=this.items[this.keys[s]],t in o&&(o[t]in l||(l[o[t]]=[]),l[o[t]].push(this.keys[s]));for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(r=mapInternal.call(this,[],l[a],i,n,c,p),r.length&&(u.push(e.call(null,a)),Array.prototype.push.apply(u,r),p+=r.length));return u},app.util.OrderedMap.prototype.addRange=function(t){var e;if(t)for(e=0;e<t.length;e+=1)this.push(t[e])},app.util.OrderedMap.prototype.get=function(t){return this.items[t]},app.util.OrderedMap.prototype.getIndex=function(t){return this.items[this.keys[t]]};var mapInternal=function(t,e,i,n,o,s){var a,r,l=e.length;if(i){for(a=0;l>a;a+=1)r=e[a],(!n||n.call(null,this.items[r]))&&t.push(i.call(null,this.items[r],a,l,a+s,o));return t}};app.util.OrderedMap.prototype.map=function(t,e){return mapInternal.call(this,[],this.keys,t,e)},app.util.OrderedMap.prototype.getKey=function(t){if("_id"in t)return t._id;throw new Error("Unknown ID, please pass proper Todo object.")};var app=app||{};app.aisles=["Produce","Diary","Bakery","Meat","Deli","Frozen","Organic","Household","Grocery","Other"];var rules=[{key:"apple",aisle:"Produce"},{key:"berries",aisle:"Produce"},{key:"pear",aisle:"Produce"},{key:"persimmon",aisle:"Produce"},{key:"plum",aisle:"Produce"},{key:"pumpkin",aisle:"Produce"},{key:"orange",aisle:"Produce"},{key:"longan",aisle:"Produce"},{key:"lettuce",aisle:"Produce"},{key:"grape",aisle:"Produce"},{key:"pepper",aisle:"Produce"},{key:"bean",aisle:"Produce"},{key:"mushroom",aisle:"Produce"},{key:"mango",aisle:"Produce"},{key:"melon",aisle:"Produce"},{key:"lemon",aisle:"Produce"},{key:"lime",aisle:"Produce"},{key:"milk",aisle:"Dairy"},{key:"cheese",aisle:"Dairy"},{key:"yogurt",aisle:"Dairy"},{key:"egg",aisle:"Dairy"},{key:"chicken",aisle:"Meat"},{key:"beef",aisle:"Meat"},{key:"ham",aisle:"Meat"},{key:"donut",aisle:"Bakery"},{key:"doughnut",aisle:"Bakery"},{key:"muffin",aisle:"Bakery"},{key:"bagel",aisle:"Bakery"},{key:"cake",aisle:"Bakery"},{key:"pie",aisle:"Bakery"},{key:"scone",aisle:"Bakery"},{key:"meatball",aisle:"Deli"},{key:"tenders",aisle:"Deli"},{key:"wonton",aisle:"Frozen"},{key:"dumpling",aisle:"Frozen"},{key:"pizza",aisle:"Frozen"},{key:"cuisine",aisle:"Frozen"},{key:"slider",aisle:"Frozen"},{key:"eggo",aisle:"Frozen"},{key:"jam",aisle:"Grocery"},{key:/\bcan\b/i,aisle:"Grocery"},{key:"heinz",aisle:"Grocery"},{key:"noodle",aisle:"Grocery"},{key:"juice",aisle:"Grocery"},{key:"jam",aisle:"Grocery"},{key:/jell[yo]/i,aisle:"Grocery"},{key:"organic",aisle:"Organic"},{key:"protein",aisle:"Organic"},{key:/(almond|soy|coconut) milk/i,aisle:"Organic"}],toAisle=function(t){var e;for(e=rules.length-1;e>=0;e-=1)if("string"==typeof rules[e].key){if(t.toLowerCase().indexOf(rules[e].key)>-1)return rules[e].aisle}else if(rules[e].key.test(t))return rules[e].aisle;return"Grocery"};app.Todo=function(t){this._id=t._id||(new Date).toJSON(),this._rev=t._rev,this.title=m.prop(t.title),this.completed=m.prop(t.completed||!1),this.editing=m.prop(t.editing||!1),this.aisle=m.prop(t.aisle),this.muted=m.prop(!1),this.expanded=m.prop(!1),this.groupBy=this.aisle()||toAisle(this.title())},app.Todo.prototype.update=function(t){this._rev=t._rev,this.title(t.title),this.completed(t.completed),this.editing(t.editing),this.aisle(t.aisle),this.groupBy=this.aisle()||toAisle(this.title())},app.Todo.prototype.setAisle=function(t){this.aisle(t),this.groupBy=t},app.Todo.prototype.toJSON=function(){var t={_id:this._id,_rev:this._rev,title:this.title(),editing:this.editing(),completed:this.completed()};return this.aisle()&&(t.aisle=this.aisle()),t};var app=app||{};app.db=app.db||{remote:"https://colinbate.cloudant.com/shopping-colin/",id:"shopping-colin"},function(){var t=app.db.id,e=new PouchDB(t),i=new PouchDB(app.db.remote);app.storage={sync:function(t,n,o){var s=e.sync(i,{live:!0,retry:!0});t&&s.on("paused",t),n&&s.on("active",n),o&&s.on("error",o||function(t){window.console.error(t)})},get:function(t){return e.allDocs({include_docs:!0,descending:t||!1}).then(function(t){return t.rows.map(function(t){return new app.Todo(t.doc)})})},save:function(t,i){var n=this,o=t.toJSON();return i=i||1,e.put(o).then(function(e){return e.ok&&(t._rev=e.rev),e})["catch"](function(s){return 409===s.status&&4>i?(window.console.log("Conflict (409), retry",i),e.get(o._id).then(function(e){return t._rev=e._rev,n.save(t,i+1)})):void window.console.error(s)})},remove:function(t){return e.remove(t.toJSON())},subscribe:function(t){if("function"!=typeof t)throw new Error("Callback must be a function");var i=e.changes({since:"now",live:!0,include_docs:!0});return i.addListener("change",t),function(){i.removeListener("change",t)}}},app.cache={get:function(){var e=JSON.parse(window.localStorage.getItem(t)||"[]");return e.map(function(t){return new app.Todo(t)})},set:function(e){var i=e.map(function(t){return t.toJSON()});window.localStorage.setItem(t,JSON.stringify(i))},getSetting:function(e){return JSON.parse(window.localStorage.getItem(t+".setting."+e)||"false")},saveSetting:function(e,i){window.localStorage.setItem(t+".setting."+e,JSON.stringify(i))}};var n=function(t){return function(){return null==this.list&&this.load(),t.apply(this,arguments)}},o=function(t){return function(){var e=t.apply(this,arguments);return this.save(),e}};app.rules={list:null,load:function(){this.list=app.cache.getSetting("assignments")||{}},save:function(){null!=this.list&&app.cache.saveSetting("assignments",this.list)},add:n(o(function(t,e){t=t.toLowerCase(),this.list[t]=e})),remove:n(o(function(t){delete this.list[t]})),clear:o(function(t){this.list={}}),match:n(function(t){return t=t.toLowerCase(),this.list[t]}),count:n(function(){return Object.keys(this.list).length})}}();var app=app||{};app.controller=function(){var t=this;this.list=new app.util.OrderedMap(app.cache.get()),this.focusInit=!1,this.spinner=m.prop(!this.list.length),this.activeSync=m.prop(!1),this.aisles=m.prop(),this.sortDesc=m.prop(!1),this.settingsWindow=m.prop("closed"),this.openItem=m.prop(null),this.settings=[{name:"sortDesc",label:"Sort newest first",reload:!0},{name:"showAisles",label:"Group by aisle",valueMap:function(t){this.aisles(t?"groupBy":"")}}];var e=function(t,e){e in this&&this[e](t)};this.loadSettings=function(){var t,i;for(t=this.settings.length-1;t>=0;t-=1)i=app.cache.getSetting(this.settings[t].name),this.settings[t].value=i,(this.settings[t].valueMap||e).call(this,i,this.settings[t].name)},this.updateSetting=function(t){t.value=!t.value,app.cache.saveSetting(t.name,t.value),(t.valueMap||e).call(this,t.value,t.name),t.reload&&n()};{var i=function(e){var i=t.sortDesc()?"unshift":"push";m.startComputation(),e.deleted?t.list.containsKey(e.id)&&(window.console.log("deleting",e.id),t.list.removeKey(e.id),t.removeNotification(e.id)):t.list.containsKey(e.id)?(window.console.log("updating",e.id),t.list.get(e.id).update(e.doc)):(window.console.log("adding",e.id),t.list[i](new app.Todo(e.doc)),t.addNotification("Added: "+e.doc.title,e.id)),app.cache.set(t.list),m.endComputation()},n=function(){app.storage.get(t.sortDesc()).then(function(e){m.startComputation(),t.list=new app.util.OrderedMap(e),app.cache.set(t.list),t.spinner(!1),m.endComputation()})},o=function(e){m.startComputation(),t.activeSync(!1),m.endComputation()},s=function(t){console.error("ERROR",t)},a=function(){m.startComputation(),t.activeSync(!0),m.endComputation()};app.storage.subscribe(i)}this.loadSettings(),app.storage.sync(o,a,s),n(),this.title=m.prop(""),this.filter=m.prop(m.route.param("filter")||""),this.getPref=function(t){return app.cache.prefGet(t)},this.add=function(){var e,i=this.title().trim(),n=t.sortDesc()?"unshift":"push";if(i){var o={title:i},s=app.rules.match(i);s&&(o.aisle=s),e=new app.Todo(o),this.list[n](e),app.storage.save(e),app.cache.set(this.list)}this.title("")},this.isVisible=function(t){switch(this.filter()){case"active":return!t.completed();case"completed":return t.completed();default:return!0}},this.clearCustomRules=function(){app.rules.clear()},this.customRuleCount=function(){return app.rules.count()},this.expand=function(t){t.expanded(!t.expanded()),t.expanded()?(this.openItem()&&this.expand(this.openItem()),this.openItem(t)):this.openItem(null)},this.changeAisle=function(t,e){var i=e.target.value;i!==t.groupBy&&(t.setAisle(i),t.expanded(!1),app.rules.add(t.title(),i),app.storage.save(t),app.cache.set(this.list))},this.toggleMuted=function(t){t.completed()||t.muted(!t.muted())},this.complete=function(t){t.completed()?t.completed(!1):(t.completed(!0),t.muted(!1)),app.storage.save(t),app.cache.set(this.list)},this.edit=function(t){t.previousTitle=t.title(),t.editing(!0),this.focusInit=!1},this.doneEditing=function(t){t.editing(!1),t.title(t.title().trim()),t.title()?app.storage.save(t):(this.list.removeItem(t),app.storage.remove(t)),app.cache.set(this.list)},this.cancelEditing=function(t){t.title(t.previousTitle),t.editing(!1)},this.clearTitle=function(){this.title("")},this.remove=function(t){this.list.removeItem(t),app.storage.remove(t),app.cache.set(this.list)},this.clearCompleted=function(){for(var t,e=this.list.length-1;e>=0;e--)t=this.list.getIndex(e),t.completed()&&(app.storage.remove(t),this.list.removeIndex(e));app.cache.set(this.list)},this.amountCompleted=function(){for(var t=0,e=0;e<this.list.length;e++)this.list.getIndex(e).completed()&&t++;return t},this.allCompleted=function(){for(var t=0;t<this.list.length;t++)if(!this.list.getIndex(t).completed())return!1;return!0},this.openSettings=function(){this.settingsWindow("open")},this.closeSettings=function(){this.settingsWindow("close")},this.setupNotify=function(){window.Notification&&"granted"!==Notification.permission&&Notification.requestPermission()},this.canSetupNotify=function(){return!!window.Notification},this.notifyCount=0,this.notifyTimer=null,this.notifyBody="",this.notifyIds={},this.addNotification=function(t,e){var i=this;window.Notification&&"granted"===Notification.permission&&(this.notifyCount+=1,this.notifyIds[e]=t,this.notifyBody=this.notifyCount>1?"Added: "+this.notifyCount+" items":t,this.notifyTimer&&clearTimeout(this.notifyTimer),this.notifyTimer=setTimeout(function(){i.notify(i.notifyBody),i.notifyCount=0,i.notifyIds={}},45e3))},this.removeNotification=function(t){var e;if(t in this.notifyIds)if(this.notifyCount-=1,0===this.notifyCount)clearTimeout(this.notifyTimer),this.notifyIds={};else if(delete this.notifyIds[t],1===this.notifyCount)for(e in this.notifyIds)Object.prototype.hasOwnProperty.call(this.notifyIds,e)&&(this.notifyBody=this.notifyIds[e]);else this.notifyBody="Added: "+this.notifyCount+" items"},this.notify=function(t){if(window.Notification&&"granted"===Notification.permission){new Notification("Shopping",{body:t,icon:"img/basket.png"})}}};var app=app||{};app.watchInput=function(t,e){return function(i){i.keyCode===app.ENTER_KEY?t():i.keyCode===app.ESC_KEY&&e()}},app.view=function(){var t=!1;return function(e){return[m("div#settings",{"class":e.settingsWindow()},[m("h2","Settings"),m("ul",e.settings.map(function(t){return m("li.setting.toggle",[m("label",t.label),m("input.value[type=checkbox]",{onclick:e.updateSetting.bind(e,t),checked:t.value})])})),m("div.setting.button",{hidden:!e.canSetupNotify()},[m("button.ask-notify[type=button]",{onclick:e.setupNotify.bind(e)},"Setup Notifications")]),m("div.setting.button",[m("button.ask[type=button]",{onclick:e.clearCustomRules.bind(e)},"Clear Custom Rules ("+e.customRuleCount()+")")]),m("button.close[type=button]",{onclick:e.closeSettings.bind(e)},"Close Settings"),m(".note","Settings are saved local to this device only."),m(".note","Shopping App 0.20.0")]),m("header#header",[m('input#new-todo[placeholder="What do we need to buy?"]',{onkeyup:app.watchInput(e.add.bind(e),e.clearTitle.bind(e)),value:e.title(),oninput:m.withAttr("value",e.title),config:function(e){t||(e.focus(),t=!0)}})]),e.spinner()?m("div#load",m("div.loader","Loading...")):"",m("section#main",{style:{display:e.list.length?"":"none"}},[m("ul#todo-list",[e.list.groupByMap(e.aisles(),function(t){return m("li",{key:t,id:t,"class":"aisle"},m("label",t))},function(t,i,n,o,s){var a=s-o;return m("li",{key:t._id,id:t._id,style:{zIndex:a},"class":function(){var e="";return e+=t.completed()?"completed":"",e+=t.editing()?" editing":"",e+=t.expanded()?" expanded":"",e+=t.muted()?" muted":""}()},[m(".view",[m("button.expand[type=button]",{onclick:e.expand.bind(e,t)}),m("label",{onclick:e.toggleMuted.bind(e,t),ondblclick:e.edit.bind(e,t)},t.title()),m("input.toggle[type=checkbox]",{onclick:m.withAttr("checked",e.complete.bind(e,t)),checked:t.completed()})]),m("input.edit",{value:t.title(),onkeyup:app.watchInput(e.doneEditing.bind(e,t),e.cancelEditing.bind(e,t)),oninput:m.withAttr("value",t.title),config:function(i){t.editing()&&!e.focusInit&&(i.focus(),i.selectionStart=i.value.length,e.focusInit=!0)},onblur:e.doneEditing.bind(e,t)}),m(".opts",[m("button.destroy[type=button]",{onclick:e.remove.bind(e,t)}),m(".aisleOpt",m("select",{onchange:e.changeAisle.bind(e,t)},app.aisles.map(function(e){return m("option",{value:e,selected:t.groupBy===e},e)})))])])},e.isVisible.bind(e))])]),app.footer(e)]}}();var app=app||{};app.footer=function(t){return m("footer#footer",{"class":t.activeSync()?"syncing":""},[m("span#todo-count",[m("button.open-settings[type=button]",{onclick:t.openSettings.bind(t)},m.trust("&nbsp;"))]),0===t.list.length?"":m("ul#filters",[m("li",[m("a[href=/]",{config:m.route,"class":""===t.filter()?"selected":""},"All")]),m("li",[m("a[href=/active]",{config:m.route,"class":"active"===t.filter()?"selected":""},"Unpurchased")])]),0===t.amountCompleted()?"":m("button#clear-completed",{onclick:t.clearCompleted.bind(t)},"Clear")])};var app=app||{};app.ENTER_KEY=13,app.ESC_KEY=27,m.route.mode="hash",m.route(document.getElementById("todoapp"),"/",{"/":app,"/:filter":app}),FastClick.attach(document.body),window.applicationCache&&(window.applicationCache.addEventListener("updateready",onUpdateReady),window.applicationCache.status===window.applicationCache.UPDATEREADY&&onUpdateReady());